---
title: "DA 401"
author: "Zoe Pratt"
date: "3/1/2022"
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)
library(ggthemes)
library(car)
library(rstatix)
```


```{r}
raw = read.csv('/Users/zoepratt/Documents/GitHub/Top-Chess-Players/data/player_piece_sac_data.csv')
```

```{r}
game_data <- raw %>%
  filter(player != 'Botvinnik' & player != 'Capablanca' & player != 'Fischer' & player != 'Morphy')

game_data <- game_data %>%
  select(-file_name)

game_data %>% count(player)
```

```{r}
alekhine <- game_data%>%
  filter(player == 'Alekhine')

anand <- game_data %>%
  filter(player == 'Anand')

carlsen <- game_data %>%
  filter(player == 'Carlsen')

caruana <- game_data %>%
  filter(player == 'Caruana')

kasparov <- game_data %>%
  filter(player == 'Kasparov')

nakamura <- game_data %>%
  filter(player == 'Nakamura')

polgar <- game_data %>%
  filter(player == 'Polgar')

tal <- game_data %>%
  filter(player == 'Tal')
```

```{r}
game_data %>%
  group_by(player) %>%
  identify_outliers(moves)
```

```{r}
t.test(nakamura$moves, tal$moves)
```

```{r}
ggplot(game_data, aes(x = player, y = moves))+
  geom_boxplot() +
  labs(x = 'Player', y='Number of Moves in Chess Match', title = 'Number of Moves in a Match by Player') +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

```
```{r}
ggplot(game_data, aes(x = player, y = total_sac))+
  geom_boxplot() + 
  labs(x = 'Player', y='Number of Pieces Sacrificed in Chess Match', title = 'Number of Pieces Sacrificed in a Match by Player') + theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
ggplot(game_data, aes(x = player, y = total_sac))+
  geom_boxplot() + 
  labs(x = 'Player', y='Number of Pieces Sacrificed in Chess Match', title = 'Number of Pieces Sacrificed in a Match by Player') +
  theme(plot.background = element_rect(fill = "wheat"), panel.background = element_rect(fill = "wheat")) +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r}
moves_anova <- aov(moves ~ player, data = game_data)
# Summary of the analysis
summary(moves_anova)
TukeyHSD(moves_anova)
```

```{r}
sac_anova <- aov(total_sac ~ player, data = game_data)
# Summary of the analysis
summary(sac_anova)
TukeyHSD(sac_anova)
```
```{r}
plot(moves_anova, 2)
```


